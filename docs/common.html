<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Common Structures Specification - go-i2p/common</title>
  <link rel="stylesheet" href="../style.css">
</head>
<body>
  <nav class="nav-sidebar">
    <div class="repo-info">
      <h2>
        <a href="../index.html">go-i2p/common</a>
      </h2>
      <div class="repo-meta">
        üìù 255 commits
         ‚Ä¢ üìú MIT License
      </div>
    </div>
    
    <ul class="nav-links">
      <li><a href="../index.html">Repository Overview</a></li>
      
      
        <div class="nav-section-title">Documentation:</div>
        
          <li><a href="../docs/common.html" class="active">Common Structures Specification</a></li>
        
          <li><a href="../docs/RELEASE_NOTES.html" >RELEASE NOTES</a></li>
        
          <li><a href="../docs/template.html" >Template</a></li>
        
      
    </ul>
    
    <div class="nav-footer">
      <a href="https://github.com/go-i2p/common" target="_blank">View on GitHub</a>
    </div>
  </nav>
  
  <div class="main-content">
    <header class="page-header">
      <h1>Common Structures Specification - go-i2p/common</h1>
    </header>
    
    <main>
      <div class="doc-content">
        <h1 id="common-structures-specification">Common Structures Specification</h1>

<blockquote>
<p><strong>Category:</strong> Design<br>
<strong>Last Updated:</strong> 2025-04<br>
<strong>Accurate For:</strong> 0.9.66</p>
</blockquote>

<hr>

<p>This document describes some data types common to all I2P protocols, like
I2NP, I2CP, SSU, etc.</p>

<hr>

<h2 id="common-type-specification">Common Type Specification</h2>

<h3 id="integer">Integer</h3>

<h4 id="description">Description</h4>

<p>Represents a non-negative integer.</p>

<h4 id="contents">Contents</h4>

<p>1 to 8 bytes in network byte order (big endian) representing an unsigned integer.</p>

<hr>

<h3 id="date">Date</h3>

<h4 id="description-1">Description</h4>

<p>The number of milliseconds since midnight on January 1, 1970 in the GMT timezone.
If the number is 0, the date is undefined or null.</p>

<h4 id="contents-1">Contents</h4>

<p>8 byte <a href="#integer">Integer</a></p>

<hr>

<h3 id="string">String</h3>

<h4 id="description-2">Description</h4>

<p>Represents a UTF-8 encoded string.</p>

<h4 id="contents-2">Contents</h4>

<p>1 or more bytes where the first byte is the number of bytes (not characters!)
in the string and the remaining 0‚Äì255 bytes are the non-null terminated UTF-8
encoded character array. Length limit is 255 bytes (not characters). Length
may be 0.</p>

<hr>

<h3 id="publickey">PublicKey</h3>

<h4 id="description-3">Description</h4>

<p>This structure is used in ElGamal or other asymmetric encryption, representing only the exponent,
not the primes, which are constant and defined in the cryptography
specification (ElGamal).
Other encryption schemes are in the process of being defined, see the table below.</p>

<h4 id="contents-3">Contents</h4>

<p>Key type and length are inferred from context or are specified in the Key
Certificate of a Destination or RouterInfo, or the fields in a <a href="#leaseset2">LeaseSet2</a> or other data structure.
The default type is ElGamal. As of release
0.9.38, other types may be supported, depending on context.
Keys are big-endian unless otherwise noted.</p>

<p>X25519 keys are supported in Destinations and LeaseSet2 as of release 0.9.44.
X25519 keys are supported in RouterIdentities as of release 0.9.48.</p>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Length (bytes)</th>
<th>Since</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>ElGamal</td>
<td align="center">256</td>
<td></td>
<td>Deprecated for Router Identities as of 0.9.58; use for Destinations, as the public key field is unused there; discouraged for leasesets</td>
</tr>

<tr>
<td>P256</td>
<td align="center">64</td>
<td>TBD</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>P384</td>
<td align="center">96</td>
<td>TBD</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>P521</td>
<td align="center">132</td>
<td>TBD</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>X25519</td>
<td align="center">32</td>
<td>0.9.38</td>
<td>Little-endian. See ECIES and ECIES-ROUTERS</td>
</tr>
</tbody>
</table>

<hr>

<h3 id="privatekey">PrivateKey</h3>

<h4 id="description-4">Description</h4>

<p>This structure is used in ElGamal or other asymmetric decryption, representing only the exponent,
not the primes which are constant and defined in the cryptography specification
(ElGamal).
Other encryption schemes are in the process of being defined, see the table below.</p>

<h4 id="contents-4">Contents</h4>

<p>Key type and length are inferred from context or are stored separately
in a data structure or a private key file.
The default type is ElGamal. As of release
0.9.38, other types may be supported, depending on context.
Keys are big-endian unless otherwise noted.</p>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Length (bytes)</th>
<th>Since</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>ElGamal</td>
<td align="center">256</td>
<td></td>
<td>Deprecated for Router Identities as of 0.9.58; use for Destinations, as the public key field is unused there; discouraged for leasesets</td>
</tr>

<tr>
<td>P256</td>
<td align="center">32</td>
<td>TBD</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>P384</td>
<td align="center">48</td>
<td>TBD</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>P521</td>
<td align="center">66</td>
<td>TBD</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>X25519</td>
<td align="center">32</td>
<td>0.9.38</td>
<td>Little-endian. See ECIES and ECIES-ROUTERS</td>
</tr>
</tbody>
</table>

<hr>

<h3 id="sessionkey">SessionKey</h3>

<h4 id="description-5">Description</h4>

<p>This structure is used for symmetric AES256 encryption and decryption.</p>

<h4 id="contents-5">Contents</h4>

<p>32 bytes</p>

<hr>

<h3 id="signingpublickey">SigningPublicKey</h3>

<h4 id="description-6">Description</h4>

<p>This structure is used for verifying signatures.</p>

<h4 id="contents-6">Contents</h4>

<p>Key type and length are inferred from context or are specified in the Key
Certificate of a Destination. The default type is DSA_SHA1. As of release
0.9.12, other types may be supported, depending on context.</p>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Length (bytes)</th>
<th>Since</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>DSA_SHA1</td>
<td align="center">128</td>
<td></td>
<td>Deprecated for Router Identities as of 0.9.58; discouraged for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA256_P256</td>
<td align="center">64</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Older Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA384_P384</td>
<td align="center">96</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely used for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA512_P521</td>
<td align="center">132</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely used for Destinations</td>
</tr>

<tr>
<td>RSA_SHA256_2048</td>
<td align="center">256</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA384_3072</td>
<td align="center">384</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA512_4096</td>
<td align="center">512</td>
<td>0.9.12</td>
<td>Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519</td>
<td align="center">32</td>
<td>0.9.15</td>
<td>Recent Router Identities and Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519ph</td>
<td align="center">32</td>
<td>0.9.25</td>
<td>Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RedDSA_SHA512_Ed25519</td>
<td align="center">32</td>
<td>0.9.39</td>
<td>For Destinations and encrypted leasesets only, never used for Router Identities</td>
</tr>
</tbody>
</table>

<h4 id="notes">Notes</h4>

<ul>
<li><p>When a key is composed of two elements (for example points X,Y), it is
serialized by padding each element to length/2 with leading zeros if
necessary.</p></li>

<li><p>All types are Big Endian, except for EdDSA and RedDSA, which are stored and transmitted
in a Little Endian format.</p></li>
</ul>

<hr>

<h3 id="signingprivatekey">SigningPrivateKey</h3>

<h4 id="description-7">Description</h4>

<p>This structure is used for creating signatures.</p>

<h4 id="contents-7">Contents</h4>

<p>Key type and length are specified when created. The default type is DSA_SHA1.
As of release 0.9.12, other types may be supported, depending on context.</p>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Length (bytes)</th>
<th>Since</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>DSA_SHA1</td>
<td align="center">20</td>
<td></td>
<td>Deprecated for Router Identities as of 0.9.58; discouraged for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA256_P256</td>
<td align="center">32</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Older Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA384_P384</td>
<td align="center">48</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely used for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA512_P521</td>
<td align="center">66</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely used for Destinations</td>
</tr>

<tr>
<td>RSA_SHA256_2048</td>
<td align="center">512</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA384_3072</td>
<td align="center">768</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA512_4096</td>
<td align="center">1024</td>
<td>0.9.12</td>
<td>Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519</td>
<td align="center">32</td>
<td>0.9.15</td>
<td>Recent Router Identities and Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519ph</td>
<td align="center">32</td>
<td>0.9.25</td>
<td>Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RedDSA_SHA512_Ed25519</td>
<td align="center">32</td>
<td>0.9.39</td>
<td>For Destinations and encrypted leasesets only, never used for Router Identities</td>
</tr>
</tbody>
</table>

<h4 id="notes-1">Notes</h4>

<ul>
<li><p>When a key is composed of two elements (for example points X,Y), it is
serialized by padding each element to length/2 with leading zeros if
necessary.</p></li>

<li><p>All types are Big Endian, except for EdDSA and RedDSA, which are stored and transmitted
in a Little Endian format.</p></li>
</ul>

<hr>

<h3 id="signature">Signature</h3>

<h4 id="description-8">Description</h4>

<p>This structure represents the signature of some data.</p>

<h4 id="contents-8">Contents</h4>

<p>Signature type and length are inferred from the type of key used. The default
type is DSA_SHA1. As of release 0.9.12, other types may be supported,
depending on context.</p>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Length (bytes)</th>
<th>Since</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>DSA_SHA1</td>
<td align="center">40</td>
<td></td>
<td>Deprecated for Router Identities as of 0.9.58; discouraged for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA256_P256</td>
<td align="center">64</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Older Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA384_P384</td>
<td align="center">96</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely used for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA512_P521</td>
<td align="center">132</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely used for Destinations</td>
</tr>

<tr>
<td>RSA_SHA256_2048</td>
<td align="center">256</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA384_3072</td>
<td align="center">384</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA512_4096</td>
<td align="center">512</td>
<td>0.9.12</td>
<td>Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519</td>
<td align="center">64</td>
<td>0.9.15</td>
<td>Recent Router Identities and Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519ph</td>
<td align="center">64</td>
<td>0.9.25</td>
<td>Offline signing, never used for Router Identities or Destinations</td>
</tr>

<tr>
<td>RedDSA_SHA512_Ed25519</td>
<td align="center">64</td>
<td>0.9.39</td>
<td>For Destinations and encrypted leasesets only, never used for Router Identities</td>
</tr>
</tbody>
</table>

<h4 id="notes-2">Notes</h4>

<ul>
<li><p>When a signature is composed of two elements (for example values R,S), it is
serialized by padding each element to length/2 with leading zeros if
necessary.</p></li>

<li><p>All types are Big Endian, except for EdDSA and RedDSA, which are stored and transmitted
in a Little Endian format.</p></li>
</ul>

<hr>

<h3 id="hash">Hash</h3>

<h4 id="description-9">Description</h4>

<p>Represents the SHA256 of some data.</p>

<h4 id="contents-9">Contents</h4>

<p>32 bytes</p>

<hr>

<h3 id="session-tag">Session Tag</h3>

<blockquote>
<p><strong>Note:</strong> Session Tags for ECIES-X25519 destinations (ratchet) and ECIES-X25519 routers
are 8 bytes. See ECIES and ECIES-ROUTERS.</p>
</blockquote>

<h4 id="description-10">Description</h4>

<p>A random number.</p>

<h4 id="contents-10">Contents</h4>

<p>32 bytes</p>

<hr>

<h3 id="tunnelid">TunnelId</h3>

<h4 id="description-11">Description</h4>

<p>Defines an identifier that is unique to each router in a tunnel. A Tunnel ID
is generally greater than zero; do not use a value of zero except in special
cases.</p>

<h4 id="contents-11">Contents</h4>

<p>4 byte <a href="#integer">Integer</a></p>

<hr>

<h3 id="certificate">Certificate</h3>

<h4 id="description-12">Description</h4>

<p>A certificate is a container for various receipts or proof of works used
throughout the I2P network.</p>

<h4 id="contents-12">Contents</h4>

<p>1 byte <a href="#integer">Integer</a> specifying certificate type, followed by a 2 byte <a href="#integer">Integer</a>
specifying the size of the certificate payload, then that many bytes.</p>

<pre><code>+----+----+----+----+----+-//
|type| length  | payload
+----+----+----+----+----+-//

type :: Integer
        length -&gt; 1 byte

        case 0 -&gt; NULL
        case 1 -&gt; HASHCASH
        case 2 -&gt; HIDDEN
        case 3 -&gt; SIGNED
        case 4 -&gt; MULTIPLE
        case 5 -&gt; KEY

length :: Integer
          length -&gt; 2 bytes

payload :: data
           length -&gt; $length bytes
</code></pre>

<h4 id="notes-3">Notes</h4>

<ul>
<li><p>For <a href="#routeridentity">Router Identities</a>, the Certificate is always NULL through version
0.9.15. As of 0.9.16, a Key Certificate is used to specify the
key types. As of 0.9.48, X25519 encryption public key types
are allowed. See below.</p></li>

<li><p>For Garlic Cloves, the Certificate is always NULL, no others are currently
implemented.</p></li>

<li><p>For Garlic Messages, the Certificate is always NULL, no others are
currently implemented.</p></li>

<li><p>For <a href="#destination">Destinations</a>, the Certificate may be non-NULL. As of 0.9.12, a Key
Certificate may be used to specify the signing public key type. See below.</p></li>

<li><p>Implementers are cautioned to prohibit excess data in Certificates.
The appropriate length for each certificate type should be enforced.</p></li>
</ul>

<h4 id="certificate-types">Certificate Types</h4>

<p>The following certificate types are defined:</p>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Type Code</th>
<th align="center">Payload Length</th>
<th align="center">Total Length</th>
<th>Notes</th>
</tr>
</thead>

<tbody>
<tr>
<td>Null</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">3</td>
<td></td>
</tr>

<tr>
<td>HashCash</td>
<td align="center">1</td>
<td align="center">varies</td>
<td align="center">varies</td>
<td>Deprecated, unused. Payload contains an ASCII colon-separated hashcash string.</td>
</tr>

<tr>
<td>Hidden</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">3</td>
<td>Deprecated, unused. Hidden routers generally do not announce that they are hidden.</td>
</tr>

<tr>
<td>Signed</td>
<td align="center">3</td>
<td align="center">40 or 72</td>
<td align="center">43 or 75</td>
<td>Deprecated, unused. Payload contains a 40-byte DSA signature, optionally followed by the 32-byte Hash of the signing Destination.</td>
</tr>

<tr>
<td>Multiple</td>
<td align="center">4</td>
<td align="center">varies</td>
<td align="center">varies</td>
<td>Deprecated, unused. Payload contains multiple certificates.</td>
</tr>

<tr>
<td>Key</td>
<td align="center">5</td>
<td align="center">4+</td>
<td align="center">7+</td>
<td>Since 0.9.12. See below for details.</td>
</tr>
</tbody>
</table>

<h4 id="key-certificates">Key Certificates</h4>

<p>Key certificates were introduced in release 0.9.12. Prior to that release, all
PublicKeys were 256-byte ElGamal keys, and all SigningPublicKeys were 128-byte
DSA-SHA1 keys. A key certificate provides a mechanism to indicate the type of
the PublicKey and SigningPublicKey in the Destination or RouterIdentity, and to
package any key data in excess of the standard lengths.</p>

<p>By maintaining exactly 384 bytes before the certificate, and putting any excess
key data inside the certificate, we maintain compatibility for any software
that parses Destinations and Router Identities.</p>

<p>The key certificate payload contains:</p>

<table>
<thead>
<tr>
<th>Data</th>
<th align="center">Length</th>
</tr>
</thead>

<tbody>
<tr>
<td>Signing Public Key Type (Integer)</td>
<td align="center">2</td>
</tr>

<tr>
<td>Crypto Public Key Type (Integer)</td>
<td align="center">2</td>
</tr>

<tr>
<td>Excess Signing Public Key Data</td>
<td align="center">0+</td>
</tr>

<tr>
<td>Excess Crypto Public Key Data</td>
<td align="center">0+</td>
</tr>
</tbody>
</table>

<blockquote>
<p><strong>Warning:</strong> The key type order is the opposite of what you may expect;
the Signing Public Key Type is first.</p>
</blockquote>

<h5 id="signing-public-key-types">Signing Public Key Types</h5>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Type Code</th>
<th align="center">Total Public Key Length</th>
<th>Since</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>DSA_SHA1</td>
<td align="center">0</td>
<td align="center">128</td>
<td>0.9.12</td>
<td>Deprecated for Router Identities as of 0.9.58; discouraged for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA256_P256</td>
<td align="center">1</td>
<td align="center">64</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Older Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA384_P384</td>
<td align="center">2</td>
<td align="center">96</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely if ever used for Destinations</td>
</tr>

<tr>
<td>ECDSA_SHA512_P521</td>
<td align="center">3</td>
<td align="center">132</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Rarely if ever used for Destinations</td>
</tr>

<tr>
<td>RSA_SHA256_2048</td>
<td align="center">4</td>
<td align="center">256</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline only; never used in Key Certificates for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA384_3072</td>
<td align="center">5</td>
<td align="center">384</td>
<td>0.9.12</td>
<td>Deprecated ‚Äî Offline only; never used in Key Certificates for Router Identities or Destinations</td>
</tr>

<tr>
<td>RSA_SHA512_4096</td>
<td align="center">6</td>
<td align="center">512</td>
<td>0.9.12</td>
<td>Offline only; never used in Key Certificates for Router Identities or Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519</td>
<td align="center">7</td>
<td align="center">32</td>
<td>0.9.15</td>
<td>Recent Router Identities and Destinations</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519ph</td>
<td align="center">8</td>
<td align="center">32</td>
<td>0.9.25</td>
<td>Offline only; never used in Key Certificates for Router Identities or Destinations</td>
</tr>

<tr>
<td>reserved (GOST)</td>
<td align="center">9</td>
<td align="center">64</td>
<td></td>
<td>Reserved, see proposal 134</td>
</tr>

<tr>
<td>reserved (GOST)</td>
<td align="center">10</td>
<td align="center">128</td>
<td></td>
<td>Reserved, see proposal 134</td>
</tr>

<tr>
<td>RedDSA_SHA512_Ed25519</td>
<td align="center">11</td>
<td align="center">32</td>
<td>0.9.39</td>
<td>For Destinations and encrypted leasesets only; never used for Router Identities</td>
</tr>

<tr>
<td>reserved</td>
<td align="center">65280‚Äì65534</td>
<td align="center"></td>
<td></td>
<td>Reserved for experimental use</td>
</tr>

<tr>
<td>reserved</td>
<td align="center">65535</td>
<td align="center"></td>
<td></td>
<td>Reserved for future expansion</td>
</tr>
</tbody>
</table>

<h5 id="crypto-public-key-types">Crypto Public Key Types</h5>

<table>
<thead>
<tr>
<th>Type</th>
<th align="center">Type Code</th>
<th align="center">Total Public Key Length</th>
<th>Usage</th>
</tr>
</thead>

<tbody>
<tr>
<td>ElGamal</td>
<td align="center">0</td>
<td align="center">256</td>
<td>Deprecated for Router Identities as of 0.9.58; use for Destinations, as the public key field is unused there</td>
</tr>

<tr>
<td>P256</td>
<td align="center">1</td>
<td align="center">64</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>P384</td>
<td align="center">2</td>
<td align="center">96</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>P521</td>
<td align="center">3</td>
<td align="center">132</td>
<td>Reserved, see proposal 145</td>
</tr>

<tr>
<td>X25519</td>
<td align="center">4</td>
<td align="center">32</td>
<td>See ECIES and proposal 156</td>
</tr>

<tr>
<td>reserved</td>
<td align="center">65280‚Äì65534</td>
<td align="center"></td>
<td>Reserved for experimental use</td>
</tr>

<tr>
<td>reserved</td>
<td align="center">65535</td>
<td align="center"></td>
<td>Reserved for future expansion</td>
</tr>
</tbody>
</table>

<h5 id="key-layout">Key Layout</h5>

<p>When a Key Certificate is not present, the preceding 384 bytes in the
Destination or RouterIdentity are defined as the 256-byte ElGamal PublicKey
followed by the 128-byte DSA-SHA1 SigningPublicKey. When a Key Certificate is
present, the preceding 384 bytes are redefined as follows:</p>

<ul>
<li>Complete or first portion of Crypto Public Key</li>
<li>Random padding if the total lengths of the two keys are less than 384 bytes</li>
<li>Complete or first portion of Signing Public Key</li>
</ul>

<p>The Crypto Public Key is aligned at the start and the Signing Public Key is
aligned at the end. The padding (if any) is in the middle. The lengths and
boundaries of the initial key data, the padding, and the excess key data
portions in the certificates are not explicitly specified, but are derived from
the lengths of the specified key types. If the total lengths of the Crypto and
Signing Public Keys exceed 384 bytes, the remainder will be contained in the
Key Certificate. If the Crypto Public Key length is not 256 bytes, the method
for determining the boundary between the two keys is to be specified in a
future revision of this document.</p>

<h5 id="example-layouts">Example Layouts</h5>

<p>Using an ElGamal Crypto Public Key and the Signing Public Key type indicated:</p>

<table>
<thead>
<tr>
<th>Signing Key Type</th>
<th align="center">Padding Length</th>
<th align="center">Excess Signing Key Data in Cert</th>
</tr>
</thead>

<tbody>
<tr>
<td>DSA_SHA1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>

<tr>
<td>ECDSA_SHA256_P256</td>
<td align="center">64</td>
<td align="center">0</td>
</tr>

<tr>
<td>ECDSA_SHA384_P384</td>
<td align="center">32</td>
<td align="center">0</td>
</tr>

<tr>
<td>ECDSA_SHA512_P521</td>
<td align="center">0</td>
<td align="center">4</td>
</tr>

<tr>
<td>RSA_SHA256_2048</td>
<td align="center">0</td>
<td align="center">128</td>
</tr>

<tr>
<td>RSA_SHA384_3072</td>
<td align="center">0</td>
<td align="center">256</td>
</tr>

<tr>
<td>RSA_SHA512_4096</td>
<td align="center">0</td>
<td align="center">384</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519</td>
<td align="center">96</td>
<td align="center">0</td>
</tr>

<tr>
<td>EdDSA_SHA512_Ed25519ph</td>
<td align="center">96</td>
<td align="center">0</td>
</tr>
</tbody>
</table>

<h4 id="key-certificate-notes">Key Certificate Notes</h4>

<ul>
<li><p>Implementers are cautioned to prohibit excess data in Key Certificates.
The appropriate length for each certificate type should be enforced.</p></li>

<li><p>A KEY certificate with types 0,0 (ElGamal, DSA_SHA1) is allowed but discouraged.
It is not well-tested and may cause issues in some implementations.
Use a NULL certificate in the canonical representation of a
(ElGamal, DSA_SHA1) Destination or RouterIdentity, which will be 4 bytes shorter
than using a KEY certificate.</p></li>
</ul>

<hr>

<h3 id="mapping">Mapping</h3>

<h4 id="description-13">Description</h4>

<p>A set of key/value mappings or properties.</p>

<h4 id="contents-13">Contents</h4>

<p>A 2-byte size Integer followed by a series of <code>String=String;</code> pairs.</p>

<blockquote>
<p><strong>‚ö† Warning:</strong> Most uses of Mapping are in signed structures, where the
Mapping entries must be sorted by key, so the signature is immutable.
Failure to sort by key will result in signature failures!</p>
</blockquote>

<pre><code>+----+----+----+----+----+----+----+----+
|  size   | key_string (len + data)| =  |
+----+----+----+----+----+----+----+----+
| val_string (len + data)     | ;  | ...
+----+----+----+----+----+----+----+

size :: Integer
        length -&gt; 2 bytes
        Total number of bytes that follow

key_string :: String
              A string (one byte length followed by UTF-8 encoded characters)

= :: A single byte containing '='

val_string :: String
              A string (one byte length followed by UTF-8 encoded characters)

; :: A single byte containing ';'
</code></pre>

<h4 id="notes-4">Notes</h4>

<ul>
<li><p>The encoding isn&rsquo;t optimal ‚Äî we either need the <code>=</code> and <code>;</code> characters, or
the string lengths, but not both.</p></li>

<li><p>Some documentation says that the strings may not include <code>=</code> or <code>;</code> but this
encoding supports them.</p></li>

<li><p>Strings are defined to be UTF-8 but in the current implementation, I2CP uses
UTF-8 but I2NP does not. For example, UTF-8 strings in a RouterInfo options
mapping in a I2NP Database Store Message will be corrupted.</p></li>

<li><p>The encoding allows duplicate keys, however in any usage where the mapping is
signed, duplicates may cause a signature failure.</p></li>

<li><p>Mappings contained in I2NP messages (e.g. in a RouterAddress or RouterInfo)
must be sorted by key so that the signature will be invariant. Duplicate keys
are not allowed.</p></li>

<li><p>Mappings contained in an I2CP SessionConfig must be sorted by key so that
the signature will be invariant. Duplicate keys are not allowed.</p></li>

<li><p>The sort method is defined as in Java <code>String.compareTo()</code>, using the Unicode
value of the characters.</p></li>

<li><p>While it is application-dependent, keys and values are generally
case-sensitive.</p></li>

<li><p>Key and value string length limits are 255 bytes (not characters) each, plus
the length byte. Length byte may be 0.</p></li>

<li><p>Total length limit is 65535 bytes, plus the 2 byte size field, or 65537
total.</p></li>
</ul>

<hr>

<h2 id="common-structure-specification">Common Structure Specification</h2>

<h3 id="keysandcert">KeysAndCert</h3>

<h4 id="description-14">Description</h4>

<p>An encryption public key, a signing public key, and a certificate, used as
either a RouterIdentity or a Destination.</p>

<h4 id="contents-14">Contents</h4>

<p>A <a href="#publickey">PublicKey</a> followed by a <a href="#signingpublickey">SigningPublicKey</a> and then a <a href="#certificate">Certificate</a>.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| public_key                            |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| padding (optional)                    |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| signing_key                           |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| certificate                           |
+----+----+----+-//

public_key :: PublicKey (partial or full)
              length -&gt; 256 bytes or as specified in key certificate

padding :: random data
           length -&gt; 0 bytes or as specified in key certificate
           public_key length + padding length + signing_key length == 384 bytes

signing_key :: SigningPublicKey (partial or full)
               length -&gt; 128 bytes or as specified in key certificate

certificate :: Certificate
               length -&gt; &gt;= 3 bytes

total length: 387+ bytes
</code></pre>

<h4 id="padding-generation-guidelines">Padding Generation Guidelines</h4>

<p>These guidelines were proposed in Proposal 161 and implemented in API version 0.9.57.
These guidelines are backward-compatible with all versions since 0.6 (2005).
See Proposal 161 for background and further information.</p>

<p>For any currently-used combination of key types other than ElGamal + DSA-SHA1,
padding will be present. Additionally, for destinations, the 256-byte
public key field has been unused since version 0.6 (2005).</p>

<p>Implementers should generate the random data for
Destination public keys, and Destination and Router Identity padding,
so that it is compressible in various I2P protocols while
still being secure, and without having Base 64 representations appear to be corrupt or insecure.
This provides most of the benefits of removing the padding fields without any
disruptive protocol changes.</p>

<p>Strictly speaking, the 32-byte signing public key alone (in both Destinations and Router Identities)
and the 32-byte encryption public key (in Router Identities only) is a random number
that provides all the entropy necessary for the SHA-256 hashes of these structures
to be cryptographically strong and randomly distributed in the network database DHT.</p>

<p>However, out of an abundance of caution, we recommend a minimum of 32 bytes of random data
be used in the ElG public key field and padding. Additionally, if the fields were all zeros,
Base 64 destinations would contain long runs of AAAA characters, which may cause alarm
or confusion to users.</p>

<p>Repeat the 32 bytes of random data as necessary so the full KeysAndCert structure is highly compressible
in I2P protocols such as I2NP Database Store Message, Streaming SYN, SSU2 handshake, and repliable Datagrams.</p>

<p><strong>Examples:</strong></p>

<ul>
<li><p>A Router Identity with X25519 encryption type and Ed25519 signature type
will contain 10 copies (320 bytes) of the random data, for a savings of approximately 288 bytes when compressed.</p></li>

<li><p>A Destination with Ed25519 signature type
will contain 11 copies (352 bytes) of the random data, for a savings of approximately 320 bytes when compressed.</p></li>
</ul>

<p>Implementations must, of course, store the full 387+ byte structure because the SHA-256 hash of the structure
covers the full contents.</p>

<h4 id="notes-5">Notes</h4>

<ul>
<li><p>Do not assume that these are always 387 bytes! They are 387 bytes plus the
certificate length specified at bytes 385‚Äì386, which may be non-zero.</p></li>

<li><p>As of release 0.9.12, if the certificate is a Key Certificate, the boundaries
of the key fields may vary. See the <a href="#key-certificates">Key Certificates</a> section above for
details.</p></li>

<li><p>The Crypto Public Key is aligned at the start and the Signing Public Key is
aligned at the end. The padding (if any) is in the middle.</p></li>
</ul>

<hr>

<h3 id="routeridentity">RouterIdentity</h3>

<h4 id="description-15">Description</h4>

<p>Defines the way to uniquely identify a particular router.</p>

<h4 id="contents-15">Contents</h4>

<p>Identical to <a href="#keysandcert">KeysAndCert</a>.</p>

<p>See <a href="#keysandcert">KeysAndCert</a> for guidelines on generating the random data for
the padding field.</p>

<h4 id="notes-6">Notes</h4>

<ul>
<li><p>The certificate for a RouterIdentity was always NULL until release 0.9.12.</p></li>

<li><p>Do not assume that these are always 387 bytes! They are 387 bytes plus the
certificate length specified at bytes 385‚Äì386, which may be non-zero.</p></li>

<li><p>As of release 0.9.12, if the certificate is a Key Certificate, the boundaries
of the key fields may vary. See the <a href="#key-certificates">Key Certificates</a> section above for
details.</p></li>

<li><p>The Crypto Public Key is aligned at the start and the Signing Public Key is
aligned at the end. The padding (if any) is in the middle.</p></li>

<li><p>RouterIdentities with a key certificate and a ECIES_X25519 public key
are supported as of release 0.9.48.
Prior to that, all RouterIdentities were ElGamal.</p></li>
</ul>

<hr>

<h3 id="destination">Destination</h3>

<h4 id="description-16">Description</h4>

<p>A Destination defines a particular endpoint to which messages can be directed
for secure delivery.</p>

<h4 id="contents-16">Contents</h4>

<p>Identical to <a href="#keysandcert">KeysAndCert</a>, except that the public key is never used,
and may contain random data instead of a valid ElGamal Public Key.</p>

<p>See <a href="#keysandcert">KeysAndCert</a> for guidelines on generating the random data for
the public key and padding fields.</p>

<h4 id="notes-7">Notes</h4>

<ul>
<li><p>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6 (2005), it is currently unused except
for the IV for LeaseSet encryption, which is deprecated. The public key in
the LeaseSet is used instead.</p></li>

<li><p>Do not assume that these are always 387 bytes! They are 387 bytes plus the
certificate length specified at bytes 385‚Äì386, which may be non-zero.</p></li>

<li><p>As of release 0.9.12, if the certificate is a Key Certificate, the boundaries
of the key fields may vary. See the <a href="#key-certificates">Key Certificates</a> section above for
details.</p></li>

<li><p>The Crypto Public Key is aligned at the start and the Signing Public Key is
aligned at the end. The padding (if any) is in the middle.</p></li>
</ul>

<hr>

<h3 id="lease">Lease</h3>

<h4 id="description-17">Description</h4>

<p>Defines the authorization for a particular tunnel to receive messages targeting
a <a href="#destination">Destination</a>.</p>

<h4 id="contents-17">Contents</h4>

<p>SHA256 <a href="#hash">Hash</a> of the <a href="#routeridentity">RouterIdentity</a> of the gateway router, then the <a href="#tunnelid">TunnelId</a>,
and finally an end <a href="#date">Date</a>.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| tunnel_gw                             |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|     tunnel_id     |      end_date
+----+----+----+----+----+----+----+----+
                    |
+----+----+----+----+

tunnel_gw :: Hash of the RouterIdentity of the tunnel gateway
             length -&gt; 32 bytes

tunnel_id :: TunnelId
             length -&gt; 4 bytes

end_date :: Date
            length -&gt; 8 bytes
</code></pre>

<h4 id="notes-8">Notes</h4>

<ul>
<li>Total size: 44 bytes</li>
</ul>

<hr>

<h3 id="leaseset">LeaseSet</h3>

<h4 id="description-18">Description</h4>

<p>Contains all of the currently authorized <a href="#lease">Leases</a> for a particular <a href="#destination">Destination</a>,
the <a href="#publickey">PublicKey</a> to which garlic messages can be encrypted, and then the
<a href="#signingpublickey">SigningPublicKey</a> that can be used to revoke this particular version of the
structure. The LeaseSet is one of the two structures stored in the network
database (the other being <a href="#routerinfo">RouterInfo</a>), and is keyed under the SHA256 of the
contained <a href="#destination">Destination</a>.</p>

<h4 id="contents-18">Contents</h4>

<p><a href="#destination">Destination</a>, followed by a <a href="#publickey">PublicKey</a> for encryption, then a <a href="#signingpublickey">SigningPublicKey</a>
which can be used to revoke this version of the LeaseSet, then a 1 byte
<a href="#integer">Integer</a> specifying how many <a href="#lease">Lease</a> structures are in the set, followed by the
actual <a href="#lease">Lease</a> structures and finally a <a href="#signature">Signature</a> of the previous bytes signed
by the <a href="#destination">Destination</a>&rsquo;s SigningPrivateKey.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| destination                           |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| encryption_key                        |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| signing_key                           |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| num| Lease 0                          |
+----+                                  +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Lease 1                               |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Lease ($num-1)                        |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| signature                             |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+

destination :: Destination
               length -&gt; &gt;= 387+ bytes

encryption_key :: PublicKey
                  length -&gt; 256 bytes

signing_key :: SigningPublicKey
               length -&gt; 128 bytes or as specified in destination's key
                         certificate

num :: Integer
       length -&gt; 1 byte
       Number of leases to follow
       value: 0 &lt;= num &lt;= 16

leases :: [Lease]
          length -&gt; $num*44 bytes

signature :: Signature
             length -&gt; 40 bytes or as specified in destination's key
                       certificate
</code></pre>

<h4 id="notes-9">Notes</h4>

<ul>
<li><p>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently unused.</p></li>

<li><p>The encryption key is used for end-to-end ElGamal/AES+SessionTag encryption
(ElGamal-AES). It is currently generated anew at every router startup, it is
not persistent.</p></li>

<li><p>The signature may be verified using the signing public key of the
destination.</p></li>

<li><p>A LeaseSet with zero Leases is allowed but is unused.
It was intended for LeaseSet revocation, which is unimplemented.
All LeaseSet2 variants require at least one Lease.</p></li>

<li><p>The signing_key is currently unused. It was intended for LeaseSet revocation,
which is unimplemented. It is currently generated anew at every router
startup, it is not persistent. The signing key type is always the same as the
destination&rsquo;s signing key type.</p></li>

<li><p>The earliest expiration of all the Leases is treated as the timestamp or
version of the LeaseSet. Routers will generally not accept a store of a
LeaseSet unless it is &ldquo;newer&rdquo; than the current one. Take care when publishing
a new LeaseSet where the oldest Lease is the same as the oldest Lease in the
previous LeaseSet. The publishing router should generally increment the
expiration of the oldest Lease by at least 1 ms in that case.</p></li>

<li><p>Prior to release 0.9.7, when included in a DatabaseStore Message sent by the
originating router, the router set all the published leases&rsquo; expirations to
the same value, that of the earliest lease. As of release 0.9.7, the router
publishes the actual lease expiration for each lease. This is an
implementation detail and not part of the structures specification.</p></li>
</ul>

<hr>

<h3 id="lease2">Lease2</h3>

<h4 id="description-19">Description</h4>

<p>Defines the authorization for a particular tunnel to receive messages targeting
a <a href="#destination">Destination</a>.
Same as <a href="#lease">Lease</a> but with a 4-byte end_date.
Used by <a href="#leaseset2">LeaseSet2</a>.
Supported as of 0.9.38; see proposal 123 for more information.</p>

<h4 id="contents-19">Contents</h4>

<p>SHA256 <a href="#hash">Hash</a> of the <a href="#routeridentity">RouterIdentity</a> of the gateway router, then the <a href="#tunnelid">TunnelId</a>,
and finally a 4 byte end date.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| tunnel_gw                             |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|     tunnel_id     |      end_date     |
+----+----+----+----+----+----+----+----+

tunnel_gw :: Hash of the RouterIdentity of the tunnel gateway
             length -&gt; 32 bytes

tunnel_id :: TunnelId
             length -&gt; 4 bytes

end_date :: 4 byte date
            length -&gt; 4 bytes
            Seconds since the epoch, rolls over in 2106.
</code></pre>

<h4 id="notes-10">Notes</h4>

<ul>
<li>Total size: 40 bytes</li>
</ul>

<hr>

<h3 id="offlinesignature">OfflineSignature</h3>

<h4 id="description-20">Description</h4>

<p>This is an optional part of the <a href="#leaseset2header">LeaseSet2Header</a>.
Also used in streaming and I2CP.
Supported as of 0.9.38; see proposal 123 for more information.</p>

<h4 id="contents-20">Contents</h4>

<p>Contains an expiration, a sigtype and transient <a href="#signingpublickey">SigningPublicKey</a>, and a <a href="#signature">Signature</a>.</p>

<pre><code>+----+----+----+----+----+----+----+----+
|     expires       | sigtype |         |
+----+----+----+----+----+----+         +
|       transient_public_key            |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|           signature                   |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

expires :: 4 byte date
           length -&gt; 4 bytes
           Seconds since the epoch, rolls over in 2106.

sigtype :: 2 byte type of the transient_public_key
           length -&gt; 2 bytes

transient_public_key :: SigningPublicKey
                        length -&gt; As inferred from the sigtype

signature :: Signature
             length -&gt; As inferred from the sigtype of the signing public key
                       in the Destination that preceded this offline signature.
             Signature of expires timestamp, transient sig type, and public key,
             by the destination public key.
</code></pre>

<h4 id="notes-11">Notes</h4>

<ul>
<li>This section can, and should, be generated offline.</li>
</ul>

<hr>

<h3 id="leaseset2header">LeaseSet2Header</h3>

<h4 id="description-21">Description</h4>

<p>This is the common part of the <a href="#leaseset2">LeaseSet2</a> and <a href="#metaleaseset">MetaLeaseSet</a>.
Supported as of 0.9.38; see proposal 123 for more information.</p>

<h4 id="contents-21">Contents</h4>

<p>Contains the <a href="#destination">Destination</a>, two timestamps, and an optional <a href="#offlinesignature">OfflineSignature</a>.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| destination                           |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|     published     | expires |  flags  |
+----+----+----+----+----+----+----+----+
| offline_signature (optional)          |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

destination :: Destination
               length -&gt; &gt;= 387+ bytes

published :: 4 byte date
             length -&gt; 4 bytes
             Seconds since the epoch, rolls over in 2106.

expires :: 2 byte time
           length -&gt; 2 bytes
           Offset from published timestamp in seconds, 18.2 hours max

flags :: 2 bytes
  Bit order: 15 14 ... 3 2 1 0
  Bit 0: If 0, no offline keys; if 1, offline keys
  Bit 1: If 0, a standard published leaseset.
         If 1, an unpublished leaseset. Should not be flooded, published, or
         sent in response to a query. If this leaseset expires, do not query the
         netdb for a new one, unless bit 2 is set.
  Bit 2: If 0, a standard published leaseset.
         If 1, this unencrypted leaseset will be blinded and encrypted when published.
         If this leaseset expires, query the blinded location in the netdb for a new one.
         If this bit is set to 1, set bit 1 to 1 also.
         As of release 0.9.42.
  Bits 15-3: set to 0 for compatibility with future uses

offline_signature :: OfflineSignature
                     length -&gt; varies
                     Optional, only present if bit 0 is set in the flags.
</code></pre>

<h4 id="notes-12">Notes</h4>

<ul>
<li><p>Total size: 395 bytes minimum</p></li>

<li><p>Maximum actual expires time is about 660 (11 minutes) for
<a href="#leaseset2">LeaseSet2</a> and 65535 (the full 18.2 hours) for <a href="#metaleaseset">MetaLeaseSet</a>.</p></li>

<li><p><a href="#leaseset">LeaseSet</a> (1) did not have a &lsquo;published&rsquo; field, so versioning required
a search for the earliest lease. LeaseSet2 adds a &lsquo;published&rsquo; field
with a resolution of one second. Routers should rate-limit sending
new leasesets to floodfills to a rate much slower than once a second (per destination).
If this is not implemented, then the code must ensure that each new leaseset
has a &lsquo;published&rsquo; time at least one second later than the one before, or else
floodfills will not store or flood the new leaseset.</p></li>
</ul>

<hr>

<h3 id="leaseset2">LeaseSet2</h3>

<h4 id="description-22">Description</h4>

<p>Contained in a I2NP DatabaseStore message of type 3.
Supported as of 0.9.38; see proposal 123 for more information.</p>

<p>Contains all of the currently authorized <a href="#lease2">Lease2</a> for a particular <a href="#destination">Destination</a>,
and the <a href="#publickey">PublicKey</a> to which garlic messages can be encrypted.
A LeaseSet is one of the two structures stored in the network
database (the other being <a href="#routerinfo">RouterInfo</a>), and is keyed under the SHA256 of the
contained <a href="#destination">Destination</a>.</p>

<h4 id="contents-22">Contents</h4>

<p><a href="#leaseset2header">LeaseSet2Header</a>, followed by options, then one or more <a href="#publickey">PublicKey</a> for encryption,
<a href="#integer">Integer</a> specifying how many <a href="#lease2">Lease2</a> structures are in the set, followed by the
actual <a href="#lease2">Lease2</a> structures and finally a <a href="#signature">Signature</a> of the previous bytes signed
by the <a href="#destination">Destination</a>&rsquo;s SigningPrivateKey or the transient key.</p>

<pre><code>+----+----+----+----+----+----+----+----+
|         ls2_header                    |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|          options                      |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|numk| keytype0| keylen0 |              |
+----+----+----+----+----+              +
|          encryption_key_0             |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| keytypen| keylenn |                   |
+----+----+----+----+                   +
|          encryption_key_n             |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| num| Lease2 0                         |
+----+                                  +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| Lease2($num-1)                        |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| signature                             |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

ls2header :: LeaseSet2Header
             length -&gt; varies

options :: Mapping
           length -&gt; varies, 2 bytes minimum

numk :: Integer
        length -&gt; 1 byte
        Number of key types, key lengths, and PublicKeys to follow
        value: 1 &lt;= numk &lt;= max TBD

keytype :: The encryption type of the PublicKey to follow.
           length -&gt; 2 bytes

keylen :: The length of the PublicKey to follow.
          Must match the specified length of the encryption type.
          length -&gt; 2 bytes

encryption_key :: PublicKey
                  length -&gt; keylen bytes

num :: Integer
       length -&gt; 1 byte
       Number of Lease2s to follow
       value: 0 &lt;= num &lt;= 16

leases :: [Lease2]
          length -&gt; $num*40 bytes

signature :: Signature
             length -&gt; 40 bytes or as specified in destination's key
                       certificate, or by the sigtype of the transient public key,
                       if present in the header
</code></pre>

<h4 id="encryption-key-preference">Encryption Key Preference</h4>

<p>For published (server) leasesets, the encryption keys are in order of server preference,
most-preferred first. If clients support more than one encryption type, it is recommended
that they honor the server preference and select the first supported type as the
encryption method to use to connect to the server.
Generally, the newer (higher-numbered) key types are more secure or efficient and
are preferred, so the keys should be listed in reverse order of key type.</p>

<p>However, clients may, implementation-dependent, select based on their preference instead,
or use some method to determine the &ldquo;combined&rdquo; preference. This may be useful as
a configuration option, or for debugging.</p>

<p>The key order in unpublished (client) leasesets effectively does not matter, because
connections will usually not be attempted to unpublished clients.
Unless this order is used to determine a combined preference, as described above.</p>

<h4 id="options">Options</h4>

<p>As of API 0.9.66, a standard format for service record options
is defined. See proposal 167 for details.
Options other than service records, using a different format,
may be defined in the future.</p>

<p>LS2 options <strong>MUST</strong> be sorted by key, so the signature is invariant.</p>

<p>Service record options are defined as follows:</p>

<ul>
<li><code>serviceoption := optionkey optionvalue</code></li>
<li><code>optionkey := _service._proto</code></li>
<li><code>service</code> ‚Äî The symbolic name of the desired service. Must be lower case. Example: <code>&quot;smtp&quot;</code>.
Allowed chars are <code>[a-z0-9-]</code> and must not start or end with a <code>-</code>.
Standard identifiers from the DNS-SD Service Types Registry or Linux <code>/etc/services</code> must be used if defined there.</li>
<li><code>proto</code> ‚Äî The transport protocol of the desired service. Must be lower case, either <code>&quot;tcp&quot;</code> or <code>&quot;udp&quot;</code>.
<code>&quot;tcp&quot;</code> means streaming and <code>&quot;udp&quot;</code> means repliable datagrams.
Protocol indicators for raw datagrams and datagram2 may be defined later.
Allowed chars are <code>[a-z0-9-]</code> and must not start or end with a <code>-</code>.</li>
<li><code>optionvalue := self | srvrecord[,srvrecord]*</code></li>
<li><code>self := &quot;0&quot; ttl port [appoptions]</code></li>
<li><code>srvrecord := &quot;1&quot; ttl priority weight port target [appoptions]</code></li>
<li><code>ttl</code> ‚Äî Time to live, integer seconds. Positive integer. Example: <code>&quot;86400&quot;</code>.
A minimum of 86400 (one day) is recommended, see Recommendations section below for details.</li>
<li><code>priority</code> ‚Äî The priority of the target host, lower value means more preferred. Non-negative integer. Example: <code>&quot;0&quot;</code>.
Only useful if more than one record, but required even if just one record.</li>
<li><code>weight</code> ‚Äî A relative weight for records with the same priority. Higher value means more chance of getting picked. Non-negative integer. Example: <code>&quot;0&quot;</code>.
Only useful if more than one record, but required even if just one record.</li>
<li><code>port</code> ‚Äî The I2CP port on which the service is to be found. Non-negative integer. Example: <code>&quot;25&quot;</code>.
Port 0 is supported but not recommended.</li>
<li><code>target</code> ‚Äî The hostname or b32 of the destination providing the service. A valid hostname as in the Naming specification. Must be lower case.
Example: <code>&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.b32.i2p&quot;</code> or <code>&quot;example.i2p&quot;</code>.
b32 is recommended unless the hostname is &ldquo;well known&rdquo;, i.e. in official or default address books.</li>
<li><code>appoptions</code> ‚Äî Arbitrary text specific to the application, must not contain <code>&quot; &quot;</code> or <code>&quot;,&quot;</code>. Encoding is UTF-8.</li>
</ul>

<p><strong>Examples:</strong></p>

<p>In LS2 for <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.b32.i2p</code>, pointing to one SMTP server:</p>

<pre><code>&quot;_smtp._tcp&quot; &quot;1 86400 0 0 25 bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.b32.i2p&quot;
</code></pre>

<p>In LS2 for <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.b32.i2p</code>, pointing to two SMTP servers:</p>

<pre><code>&quot;_smtp._tcp&quot; &quot;1 86400 0 0 25 bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.b32.i2p,86400 1 0 25 cccccccccccccccccccccccccccccccccccccccccccc.b32.i2p&quot;
</code></pre>

<p>In LS2 for <code>bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb.b32.i2p</code>, pointing to itself as a SMTP server:</p>

<pre><code>&quot;_smtp._tcp&quot; &quot;0 999999 25&quot;
</code></pre>

<h4 id="notes-13">Notes</h4>

<ul>
<li><p>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently unused.</p></li>

<li><p>The encryption keys are used for end-to-end ElGamal/AES+SessionTag encryption
(ElGamal-AES, type 0) or other end-to-end encryption schemes.
See ECIES and proposals 145 and 156.
They may be generated anew at every router startup
or they may be persistent.
X25519 (type 4, see ECIES) is supported as of release 0.9.44.</p></li>

<li><p>The signature is over the data above, <strong>PREPENDED</strong> with the single byte
containing the DatabaseStore type (3).</p></li>

<li><p>The signature may be verified using the signing public key of the
destination, or the transient signing public key, if an offline signature
is included in the leaseset2 header.</p></li>

<li><p>The key length is provided for each key, so that floodfills and clients
may parse the structure even if not all encryption types are known or supported.</p></li>

<li><p>See note on the &lsquo;published&rsquo; field in <a href="#leaseset2header">LeaseSet2Header</a>.</p></li>

<li><p>The options mapping, if the size is greater than one, must be sorted by key, so the signature is invariant.</p></li>
</ul>

<hr>

<h3 id="metalease">MetaLease</h3>

<h4 id="description-23">Description</h4>

<p>Defines the authorization for a particular tunnel to receive messages targeting
a <a href="#destination">Destination</a>.
Same as <a href="#lease2">Lease2</a> but with flags and cost instead of a tunnel id.
Used by <a href="#metaleaseset">MetaLeaseSet</a>.
Contained in a I2NP DatabaseStore message of type 7.
Supported as of 0.9.38; see proposal 123 for more information.</p>

<h4 id="contents-23">Contents</h4>

<p>SHA256 <a href="#hash">Hash</a> of the <a href="#routeridentity">RouterIdentity</a> of the gateway router, then flags and cost,
and finally a 4 byte end date.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| tunnel_gw                             |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+
|    flags     |cost|      end_date     |
+----+----+----+----+----+----+----+----+

tunnel_gw :: Hash of the RouterIdentity of the tunnel gateway,
             or the hash of another MetaLeaseSet.
             length -&gt; 32 bytes

flags :: 3 bytes of flags
         Bit order: 23 22 ... 3 2 1 0
         Bits 3-0: Type of the entry.
         If 0, unknown.
         If 1, a LeaseSet.
         If 3, a LeaseSet2.
         If 5, a MetaLeaseSet.
         Bits 23-4: set to 0 for compatibility with future uses
         length -&gt; 3 bytes

cost :: 1 byte, 0-255. Lower value is higher priority.
        length -&gt; 1 byte

end_date :: 4 byte date
            length -&gt; 4 bytes
            Seconds since the epoch, rolls over in 2106.
</code></pre>

<h4 id="notes-14">Notes</h4>

<ul>
<li>Total size: 40 bytes</li>
</ul>

<hr>

<h3 id="metaleaseset">MetaLeaseSet</h3>

<h4 id="description-24">Description</h4>

<p>Contained in a I2NP DatabaseStore message of type 7.
Defined as of 0.9.38; scheduled to be working as of 0.9.40;
see proposal 123 for more information.</p>

<p>Contains all of the currently authorized <a href="#metalease">MetaLease</a> for a particular <a href="#destination">Destination</a>,
and the <a href="#publickey">PublicKey</a> to which garlic messages can be encrypted.
A LeaseSet is one of the two structures stored in the network
database (the other being <a href="#routerinfo">RouterInfo</a>), and is keyed under the SHA256 of the
contained <a href="#destination">Destination</a>.</p>

<h4 id="contents-24">Contents</h4>

<p><a href="#leaseset2header">LeaseSet2Header</a>, followed by options,
<a href="#integer">Integer</a> specifying how many <a href="#lease2">Lease2</a> structures are in the set, followed by the
actual <a href="#lease2">Lease2</a> structures and finally a <a href="#signature">Signature</a> of the previous bytes signed
by the <a href="#destination">Destination</a>&rsquo;s SigningPrivateKey or the transient key.</p>

<pre><code>+----+----+----+----+----+----+----+----+
|         ls2_header                    |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|          options                      |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| num| MetaLease 0                      |
+----+                                  +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| MetaLease($num-1)                     |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|numr|                                  |
+----+                                  +
|          revocation_0                 |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|          revocation_n                 |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| signature                             |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

ls2header :: LeaseSet2Header
             length -&gt; varies

options :: Mapping
           length -&gt; varies, 2 bytes minimum

num :: Integer
       length -&gt; 1 byte
       Number of MetaLeases to follow
       value: 1 &lt;= num &lt;= max TBD

leases :: MetaLeases
          length -&gt; $numr*40 bytes

numr :: Integer
        length -&gt; 1 byte
        Number of Hashes to follow
        value: 0 &lt;= numr &lt;= max TBD

revocations :: [Hash]
               length -&gt; $numr*32 bytes

signature :: Signature
             length -&gt; 40 bytes or as specified in destination's key
                       certificate, or by the sigtype of the transient public key,
                       if present in the header
</code></pre>

<h4 id="notes-15">Notes</h4>

<ul>
<li><p>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently unused.</p></li>

<li><p>The signature is over the data above, <strong>PREPENDED</strong> with the single byte
containing the DatabaseStore type (7).</p></li>

<li><p>The signature may be verified using the signing public key of the
destination, or the transient signing public key, if an offline signature
is included in the leaseset2 header.</p></li>

<li><p>See note on the &lsquo;published&rsquo; field in <a href="#leaseset2header">LeaseSet2Header</a>.</p></li>
</ul>

<hr>

<h3 id="encryptedleaseset">EncryptedLeaseSet</h3>

<h4 id="description-25">Description</h4>

<p>Contained in a I2NP DatabaseStore message of type 5.
Defined as of 0.9.38; working as of 0.9.39;
see proposal 123 for more information.</p>

<p>Only the blinded key and expiration are visible in cleartext.
The actual lease set is encrypted.</p>

<h4 id="contents-25">Contents</h4>

<p>A two byte signature type, the blinded SigningPrivateKey,
published time, expiration, and flags.
Then, a two byte length followed by encrypted data.
Finally, a <a href="#signature">Signature</a> of the previous bytes signed
by the blinded SigningPrivateKey or the transient key.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| sigtype |                             |
+----+----+                             +
|        blinded_public_key             |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|     published     | expires |  flags  |
+----+----+----+----+----+----+----+----+
| offline_signature (optional)          |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
|  len    |                             |
+----+----+                             +
|         encrypted_data                |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| signature                             |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

sigtype :: A two byte signature type of the public key to follow
           length -&gt; 2 bytes

blinded_public_key :: SigningPublicKey
                      length -&gt; As inferred from the sigtype

published :: 4 byte date
             length -&gt; 4 bytes
             Seconds since the epoch, rolls over in 2106.

expires :: 2 byte time
           length -&gt; 2 bytes
           Offset from published timestamp in seconds, 18.2 hours max

flags :: 2 bytes
  Bit order: 15 14 ... 3 2 1 0
  Bit 0: If 0, no offline keys; if 1, offline keys
  Bit 1: If 0, a standard published leaseset.
         If 1, an unpublished leaseset. Should not be flooded, published, or
         sent in response to a query. If this leaseset expires, do not query the
         netdb for a new one.
  Bits 15-2: set to 0 for compatibility with future uses

offline_signature :: OfflineSignature
                     length -&gt; varies
                     Optional, only present if bit 0 is set in the flags.

len :: Integer
       length -&gt; 2 bytes
       length of encrypted_data to follow
       value: 1 &lt;= num &lt;= max TBD

encrypted_data :: Data encrypted
                  length -&gt; len bytes

signature :: Signature
             length -&gt; As specified by the sigtype of the blinded public key,
                       or by the sigtype of the transient public key,
                       if present in the header
</code></pre>

<h4 id="notes-16">Notes</h4>

<ul>
<li><p>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently unused.</p></li>

<li><p>The signature is over the data above, <strong>PREPENDED</strong> with the single byte
containing the DatabaseStore type (5).</p></li>

<li><p>The signature may be verified using the signing public key of the
destination, or the transient signing public key, if an offline signature
is included in the leaseset2 header.</p></li>

<li><p>Blinding and encryption are specified in the EncryptedLeaseSet specification.</p></li>

<li><p>This structure does not use the <a href="#leaseset2header">LeaseSet2Header</a>.</p></li>

<li><p>Maximum actual expires time is about 660 (11 minutes), unless
it is an encrypted <a href="#metaleaseset">MetaLeaseSet</a>.</p></li>

<li><p>See proposal 123 for notes on using offline signatures
with encrypted leasesets.</p></li>

<li><p>See note on the &lsquo;published&rsquo; field in <a href="#leaseset2header">LeaseSet2Header</a>
(same issue, even though we do not use the LeaseSet2Header format here).</p></li>
</ul>

<hr>

<h3 id="routeraddress">RouterAddress</h3>

<h4 id="description-26">Description</h4>

<p>This structure defines the means to contact a router through a transport
protocol.</p>

<h4 id="contents-26">Contents</h4>

<p>1 byte <a href="#integer">Integer</a> defining the relative cost of using the address, where 0 is
free and 255 is expensive, followed by the expiration <a href="#date">Date</a> after which the
address should not be used, or if null, the address never expires. After that
comes a <a href="#string">String</a> defining the transport protocol this router address uses.
Finally there is a <a href="#mapping">Mapping</a> containing all of the transport specific options
necessary to establish the connection, such as IP address, port number, email
address, URL, etc.</p>

<pre><code>+----+----+----+----+----+----+----+----+
|cost|           expiration
+----+----+----+----+----+----+----+----+
     |        transport_style           |
+----+----+----+----+-//-+----+----+----+
|                                       |
+                                       +
|               options                 |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+

cost :: Integer
        length -&gt; 1 byte

        case 0 -&gt; free
        case 255 -&gt; expensive

expiration :: Date (must be all zeros, see notes below)
              length -&gt; 8 bytes

              case null -&gt; never expires

transport_style :: String
                   length -&gt; 1-256 bytes

options :: Mapping
</code></pre>

<h4 id="notes-17">Notes</h4>

<ul>
<li><p>Cost is typically 5 or 6 for SSU, and 10 or 11 for NTCP.</p></li>

<li><p>Expiration is currently unused, always null (all zeroes). As of release
0.9.3, the expiration is assumed zero and not stored, so any non-zero
expiration will fail in the RouterInfo signature verification. Implementing
expiration (or another use for these bytes) will be a backwards-incompatible
change. Routers MUST set this field to all zeros. As of release 0.9.12, a
non-zero expiration field is again recognized, however we must wait several
releases to use this field, until the vast majority of the network recognizes
it.</p></li>

<li><p>The following options, while not required, are standard and expected to be
present in most router addresses: <code>&quot;host&quot;</code> (an IPv4 or IPv6 address or host
name) and <code>&quot;port&quot;</code>.</p></li>
</ul>

<hr>

<h3 id="routerinfo">RouterInfo</h3>

<h4 id="description-27">Description</h4>

<p>Defines all of the data that a router wants to publish for the network to see.
The RouterInfo is one of two structures stored in the network database (the
other being <a href="#leaseset">LeaseSet</a>), and is keyed under the SHA256 of the contained
<a href="#routeridentity">RouterIdentity</a>.</p>

<h4 id="contents-27">Contents</h4>

<p><a href="#routeridentity">RouterIdentity</a> followed by the <a href="#date">Date</a>, when the entry was published.</p>

<pre><code>+----+----+----+----+----+----+----+----+
| router_ident                          |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| published                             |
+----+----+----+----+----+----+----+----+
|size| RouterAddress 0                  |
+----+                                  +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| RouterAddress 1                       |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+----+----+----+----+
| RouterAddress ($size-1)               |
+                                       +
|                                       |
~                                       ~
~                                       ~
|                                       |
+----+----+----+----+-//-+----+----+----+
|psiz| options                          |
+----+----+----+----+-//-+----+----+----+
| signature                             |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+                                       +
|                                       |
+----+----+----+----+----+----+----+----+

router_ident :: RouterIdentity
                length -&gt; &gt;= 387+ bytes

published :: Date
             length -&gt; 8 bytes

size :: Integer
        length -&gt; 1 byte
        The number of RouterAddresses to follow, 0-255

addresses :: [RouterAddress]
             length -&gt; varies

peer_size :: Integer
             length -&gt; 1 byte
             The number of peer Hashes to follow, 0-255, unused, always zero
             value -&gt; 0

options :: Mapping

signature :: Signature
             length -&gt; 40 bytes or as specified in router_ident's key
                       certificate
</code></pre>

<h4 id="notes-18">Notes</h4>

<ul>
<li><p>The peer_size Integer may be followed by a list of that many router hashes.
This is currently unused. It was intended for a form of restricted routes,
which is unimplemented.
Certain implementations may require the list to be sorted so the signature is invariant.
To be researched before enabling this feature.</p></li>

<li><p>The signature may be verified using the signing public key of the
router_ident.</p></li>

<li><p>See the network database page for standard options that
are expected to be present in all router infos.</p></li>

<li><p>Very old routers required the addresses to be sorted by the SHA256 of their data
so the signature is invariant.
This is no longer required, and not worth implementing for backward compatibility.</p></li>
</ul>

<hr>

<h3 id="delivery-instructions">Delivery Instructions</h3>

<p>Tunnel Message Delivery Instructions are defined in the Tunnel Message
Specification.</p>

<p>Garlic Message Delivery Instructions are defined in the I2NP Message
Specification.</p>

<hr>

<h2 id="references">References</h2>

<ul>
<li><strong>ECIES</strong> ‚Äî ECIES Specification</li>
<li><strong>ECIES-ROUTERS</strong> ‚Äî ECIES Routers Specification</li>
<li><strong>ELGAMAL</strong> ‚Äî ElGamal Cryptography</li>
<li><strong>ELGAMAL-AES</strong> ‚Äî ElGamal/AES+SessionTag</li>
<li><strong>GARLIC-DELIVERY</strong> ‚Äî Garlic Clove Delivery Instructions</li>
<li><strong>I2CP</strong> ‚Äî I2CP Protocol</li>
<li><strong>I2NP</strong> ‚Äî I2NP Protocol</li>
<li><strong>NAMING</strong> ‚Äî Naming Specification</li>
<li><strong>NETDB-ROUTERINFO</strong> ‚Äî Network Database RouterInfo</li>
<li><strong>REGISTRY</strong> ‚Äî DNS-SD Service Types Registry (<a href="http://www.dns-sd.org/ServiceTypes.html" target="_blank">http://www.dns-sd.org/ServiceTypes.html</a>)</li>
<li><strong>SSU</strong> ‚Äî SSU Transport</li>
<li><strong>TUNNEL-DELIVERY</strong> ‚Äî Tunnel Message Delivery Instructions</li>
</ul>

      </div>
    </main>
    
    <footer class="page-footer">
      <p>Generated on 2026-02-26 21:26:19 ‚Ä¢ <a href="https://github.com/go-i2p/common" target="_blank">View on GitHub</a></p>
    </footer>
  </div>
</body>
</html>